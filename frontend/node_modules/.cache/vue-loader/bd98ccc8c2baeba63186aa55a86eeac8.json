{"remainingRequest":"C:\\Users\\ZJ\\go\\src\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ZJ\\go\\src\\frontend\\src\\views\\Room.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\ZJ\\go\\src\\frontend\\src\\views\\Room.vue","mtime":1598758185000},{"path":"C:\\Users\\ZJ\\go\\src\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ZJ\\go\\src\\frontend\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ZJ\\go\\src\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\ZJ\\go\\src\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ZJ\\go\\src\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KCmltcG9ydCB7bWVyZ2VDb25maWcsIHRvQm9vbCwgdG9JbnR9IGZyb20gJ0AvdXRpbHMnCmltcG9ydCAqIGFzIGNvbmZpZyBmcm9tICdAL2FwaS9jb25maWcnCmltcG9ydCBDaGF0UmVuZGVyZXIgZnJvbSAnQC9jb21wb25lbnRzL0NoYXRSZW5kZXJlcicKaW1wb3J0ICogYXMgY29uc3RhbnRzIGZyb20gJ0AvY29tcG9uZW50cy9DaGF0UmVuZGVyZXIvY29uc3RhbnRzJwoKY29uc3QgQ09NTUFORF9IRUFSVEJFQVQgPSAwCmNvbnN0IENPTU1BTkRfSk9JTl9ST09NID0gMQpjb25zdCBDT01NQU5EX0FERF9URVhUID0gMgpjb25zdCBDT01NQU5EX0FERF9HSUZUID0gMwpjb25zdCBDT01NQU5EX0FERF9NRU1CRVIgPSA0CmNvbnN0IENPTU1BTkRfQUREX1NVUEVSX0NIQVQgPSA1CmNvbnN0IENPTU1BTkRfREVMX1NVUEVSX0NIQVQgPSA2CmNvbnN0IENPTU1BTkRfVVBEQVRFX1RSQU5TTEFUSU9OID0gNwpjb25zdCBDT01NQU5EX0FERF9MT1ZFID0gOApjb25zdCBDT01NQU5EX1FVSVRfUk9PTSA9IDkKY29uc3QgQ09NTUFORF9BRERfRk9MTE9XID0gMTAKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnUm9vbScsCiAgY29tcG9uZW50czogewogICAgQ2hhdFJlbmRlcmVyCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY29uZmlnOiB7Li4uY29uZmlnLkRFRkFVTFRfQ09ORklHfSwKCiAgICAgIHdlYnNvY2tldDogbnVsbCwKICAgICAgcmV0cnlDb3VudDogMCwKICAgICAgaXNEZXN0cm95aW5nOiBmYWxzZSwKICAgICAgaGVhcnRiZWF0VGltZXJJZDogbnVsbAogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGJsb2NrS2V5d29yZHMoKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbmZpZy5ibG9ja0tleXdvcmRzLnNwbGl0KCdcbicpLmZpbHRlcih2YWwgPT4gdmFsKQogICAgfSwKICAgIGJsb2NrVXNlcnMoKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbmZpZy5ibG9ja1VzZXJzLnNwbGl0KCdcbicpLmZpbHRlcih2YWwgPT4gdmFsKQogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMudXBkYXRlQ29uZmlnKCkKICAgIHRoaXMud3NDb25uZWN0KCkKICAgIC8vIOaPkOekuueUqOaIt+W3suWKoOi9vQogICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgIG1lc3NhZ2U6ICdMb2FkZWQnLAogICAgICBkdXJhdGlvbjogJzUwMCcKICAgIH0pCiAgfSwKICBiZWZvcmVEZXN0cm95KCkgewogICAgdGhpcy5pc0Rlc3Ryb3lpbmcgPSB0cnVlCiAgICB0aGlzLndlYnNvY2tldC5jbG9zZSgpCiAgfSwKICBtZXRob2RzOiB7CiAgICB1cGRhdGVDb25maWcoKSB7CiAgICAgIGxldCBjZmcgPSB7fQogICAgICAvLyDnlZnnqbrnmoTkvb/nlKjpu5jorqTlgLwKICAgICAgZm9yIChsZXQgaSBpbiB0aGlzLiRyb3V0ZS5xdWVyeSkgewogICAgICAgIGlmICh0aGlzLiRyb3V0ZS5xdWVyeVtpXSAhPT0gJycpIHsKICAgICAgICAgIGNmZ1tpXSA9IHRoaXMuJHJvdXRlLnF1ZXJ5W2ldCiAgICAgICAgfQogICAgICB9CiAgICAgIGNmZyA9IG1lcmdlQ29uZmlnKGNmZywgY29uZmlnLkRFRkFVTFRfQ09ORklHKQogICAgICBjZmcubWluR2lmdFByaWNlID0gdG9JbnQoY2ZnLm1pbkdpZnRQcmljZSwgY29uZmlnLkRFRkFVTFRfQ09ORklHLm1pbkdpZnRQcmljZSkKICAgICAgY2ZnLnNob3dEYW5tYWt1ID0gdG9Cb29sKGNmZy5zaG93RGFubWFrdSkKICAgICAgY2ZnLnNob3dMb3ZlID0gdG9Cb29sKGNmZy5zaG93TG92ZSkKICAgICAgY2ZnLnNob3dGb2xsb3cgPSB0b0Jvb2woY2ZnLnNob3dGb2xsb3cpCiAgICAgIGNmZy5zaG93Sm9pbiA9IHRvQm9vbChjZmcuc2hvd0pvaW4pCiAgICAgIGNmZy5zaG93UXVpdCA9IHRvQm9vbChjZmcuc2hvd1F1aXQpCiAgICAgIGNmZy5zaG93R2lmdCA9IHRvQm9vbChjZmcuc2hvd0dpZnQpCiAgICAgIGNmZy5zaG93R2lmdE5hbWUgPSB0b0Jvb2woY2ZnLnNob3dHaWZ0TmFtZSkKICAgICAgY2ZnLnNob3dHaWZ0UHJpY2UgPSB0b0Jvb2woY2ZnLnNob3dHaWZ0UHJpY2UpCiAgICAgIGNmZy5tZXJnZVNpbWlsYXJEYW5tYWt1ID0gdG9Cb29sKGNmZy5tZXJnZVNpbWlsYXJEYW5tYWt1KQogICAgICBjZmcubWVyZ2VTaW1pbGFyT3RoZXIgPSB0b0Jvb2woY2ZnLm1lcmdlU2ltaWxhck90aGVyKQogICAgICBjZmcubWVyZ2VHaWZ0ID0gdG9Cb29sKGNmZy5tZXJnZUdpZnQpCiAgICAgIGNmZy5tYXhOdW1iZXIgPSB0b0ludChjZmcubWF4TnVtYmVyLCBjb25maWcuREVGQVVMVF9DT05GSUcubWF4TnVtYmVyKQogICAgICBjZmcuYmxvY2tHaWZ0RGFubWFrdSA9IHRvQm9vbChjZmcuYmxvY2tHaWZ0RGFubWFrdSkKICAgICAgY2ZnLmJsb2NrTGV2ZWwgPSB0b0ludChjZmcuYmxvY2tMZXZlbCwgY29uZmlnLkRFRkFVTFRfQ09ORklHLmJsb2NrTGV2ZWwpCiAgICAgIGNmZy5ibG9ja05ld2JpZSA9IHRvQm9vbChjZmcuYmxvY2tOZXdiaWUpCiAgICAgIGNmZy5ibG9ja05vdE1vYmlsZVZlcmlmaWVkID0gdG9Cb29sKGNmZy5ibG9ja05vdE1vYmlsZVZlcmlmaWVkKQogICAgICBjZmcuYmxvY2tNZWRhbExldmVsID0gdG9JbnQoY2ZnLmJsb2NrTWVkYWxMZXZlbCwgY29uZmlnLkRFRkFVTFRfQ09ORklHLmJsb2NrTWVkYWxMZXZlbCkKICAgICAgY2ZnLmF1dG9UcmFuc2xhdGUgPSB0b0Jvb2woY2ZnLmF1dG9UcmFuc2xhdGUpCgogICAgICB0aGlzLmNvbmZpZyA9IGNmZwogICAgfSwKICAgIHdzQ29ubmVjdCgpIHsKICAgICAgY29uc3QgcHJvdG9jb2wgPSB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgPT09ICdodHRwczonID8gJ3dzcycgOiAnd3MnCiAgICAgIC8vIOW8gOWPkeaXtuS9v+eUqGxvY2FsaG9zdDoxMjQ1MAogICAgICBjb25zdCBob3N0ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyAnbG9jYWxob3N0OjEyNDUxJyA6IHdpbmRvdy5sb2NhdGlvbi5ob3N0CiAgICAgIGNvbnN0IHVybCA9IGAke3Byb3RvY29sfTovLyR7aG9zdH0vY2hhdGAKICAgICAgdGhpcy53ZWJzb2NrZXQgPSBuZXcgV2ViU29ja2V0KHVybCkKICAgICAgdGhpcy53ZWJzb2NrZXQub25vcGVuID0gdGhpcy5vbldzT3BlbgogICAgICB0aGlzLndlYnNvY2tldC5vbmNsb3NlID0gdGhpcy5vbldzQ2xvc2UKICAgICAgdGhpcy53ZWJzb2NrZXQub25tZXNzYWdlID0gdGhpcy5vbldzTWVzc2FnZQogICAgICB0aGlzLmhlYXJ0YmVhdFRpbWVySWQgPSB3aW5kb3cuc2V0SW50ZXJ2YWwodGhpcy5zZW5kSGVhcnRiZWF0LCAxMCAqIDEwMDApCiAgICB9LAogICAgc2VuZEhlYXJ0YmVhdCgpIHsKICAgICAgdGhpcy53ZWJzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgY21kOiBDT01NQU5EX0hFQVJUQkVBVAogICAgICB9KSkKICAgIH0sCiAgICBvbldzT3BlbigpIHsKICAgICAgdGhpcy5yZXRyeUNvdW50ID0gMAogICAgICB0aGlzLndlYnNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICBjbWQ6IENPTU1BTkRfSk9JTl9ST09NLAogICAgICAgIGRhdGE6IHsKICAgICAgICAgIHJvb21JZDogcGFyc2VJbnQodGhpcy4kcm91dGUucGFyYW1zLnJvb21JZCksCiAgICAgICAgICBjb25maWc6IHsKICAgICAgICAgICAgYXV0b1RyYW5zbGF0ZTogdGhpcy5jb25maWcuYXV0b1RyYW5zbGF0ZQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkpCiAgICB9LAogICAgb25Xc0Nsb3NlKCkgewogICAgICBpZiAodGhpcy5oZWFydGJlYXRUaW1lcklkKSB7CiAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5oZWFydGJlYXRUaW1lcklkKQogICAgICAgIHRoaXMuaGVhcnRiZWF0VGltZXJJZCA9IG51bGwKICAgICAgfQogICAgICBpZiAodGhpcy5pc0Rlc3Ryb3lpbmcpIHsKICAgICAgICByZXR1cm4KICAgICAgfQogICAgICB3aW5kb3cuY29uc29sZS5sb2coYOaOiee6v+mHjei/nuS4rSR7Kyt0aGlzLnJldHJ5Q291bnR9YCkKICAgICAgdGhpcy53c0Nvbm5lY3QoKQogICAgfSwKICAgIG9uV3NNZXNzYWdlKGV2ZW50KSB7CiAgICAgIGxldCB7Y21kLCBkYXRhfSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSkKICAgICAgbGV0IG1lc3NhZ2UgPSBudWxsCiAgICAgIHN3aXRjaCAoY21kKSB7CiAgICAgIGNhc2UgQ09NTUFORF9KT0lOX1JPT006CiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZy5zaG93Sm9pbiB8fCB0aGlzLm1lcmdlU2ltaWxhck90aGVyKGRhdGEuYXV0aG9yTmFtZSwgZGF0YS5jb250ZW50KSkgewogICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICAgICAgbWVzc2FnZSA9IHsKICAgICAgICAgIGlkOiBkYXRhLmlkLAogICAgICAgICAgdHlwZTogY29uc3RhbnRzLk1FU1NBR0VfVFlQRV9KT0lOLAogICAgICAgICAgYXZhdGFyVXJsOiBkYXRhLmF2YXRhclVybCwKICAgICAgICAgIHRpbWU6IG5ldyBEYXRlKGRhdGEudGltZXN0YW1wICogMTAwMCksCiAgICAgICAgICBhdXRob3JOYW1lOiBkYXRhLmF1dGhvck5hbWUsCiAgICAgICAgICBhdXRob3JUeXBlOiBkYXRhLmF1dGhvclR5cGUsCiAgICAgICAgICBjb250ZW50OiBkYXRhLmNvbnRlbnQsCiAgICAgICAgICBwcml2aWxlZ2VUeXBlOiBkYXRhLnByaXZpbGVnZVR5cGUsCiAgICAgICAgICByZXBlYXRlZDogMSwKICAgICAgICAgIHRyYW5zbGF0aW9uOiBkYXRhLnRyYW5zbGF0aW9uCiAgICAgICAgfQogICAgICAgIGJyZWFrCiAgICAgIGNhc2UgQ09NTUFORF9RVUlUX1JPT006CiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZy5zaG93UXVpdCB8fCB0aGlzLm1lcmdlU2ltaWxhck90aGVyKGRhdGEuYXV0aG9yTmFtZSwgZGF0YS5jb250ZW50KSkgewogICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICAgICAgbWVzc2FnZSA9IHsKICAgICAgICAgIGlkOiBkYXRhLmlkLAogICAgICAgICAgdHlwZTogY29uc3RhbnRzLk1FU1NBR0VfVFlQRV9RVUlULAogICAgICAgICAgYXZhdGFyVXJsOiBkYXRhLmF2YXRhclVybCwKICAgICAgICAgIHRpbWU6IG5ldyBEYXRlKGRhdGEudGltZXN0YW1wICogMTAwMCksCiAgICAgICAgICBhdXRob3JOYW1lOiBkYXRhLmF1dGhvck5hbWUsCiAgICAgICAgICBhdXRob3JUeXBlOiBkYXRhLmF1dGhvclR5cGUsCiAgICAgICAgICBjb250ZW50OiBkYXRhLmNvbnRlbnQsCiAgICAgICAgICBwcml2aWxlZ2VUeXBlOiBkYXRhLnByaXZpbGVnZVR5cGUsCiAgICAgICAgICByZXBlYXRlZDogMSwKICAgICAgICAgIHRyYW5zbGF0aW9uOiBkYXRhLnRyYW5zbGF0aW9uCiAgICAgICAgfQogICAgICAgIGJyZWFrCiAgICAgIGNhc2UgQ09NTUFORF9BRERfVEVYVDoKICAgICAgICBpZiAoIXRoaXMuY29uZmlnLnNob3dEYW5tYWt1IHx8ICF0aGlzLmZpbHRlclRleHRNZXNzYWdlKGRhdGEpIHx8IHRoaXMubWVyZ2VTaW1pbGFyVGV4dChkYXRhLmNvbnRlbnQpKSB7CiAgICAgICAgICBicmVhawogICAgICAgIH0KICAgICAgICBtZXNzYWdlID0gewogICAgICAgICAgaWQ6IGRhdGEuaWQsCiAgICAgICAgICB0eXBlOiBjb25zdGFudHMuTUVTU0FHRV9UWVBFX1RFWFQsCiAgICAgICAgICBhdmF0YXJVcmw6IGRhdGEuYXZhdGFyVXJsLAogICAgICAgICAgdGltZTogbmV3IERhdGUoZGF0YS50aW1lc3RhbXAgKiAxMDAwKSwKICAgICAgICAgIGF1dGhvck5hbWU6IGRhdGEuYXV0aG9yTmFtZSwKICAgICAgICAgIGF1dGhvclR5cGU6IGRhdGEuYXV0aG9yVHlwZSwKICAgICAgICAgIGNvbnRlbnQ6IGRhdGEuY29udGVudCwKICAgICAgICAgIHByaXZpbGVnZVR5cGU6IGRhdGEucHJpdmlsZWdlVHlwZSwKICAgICAgICAgIHJlcGVhdGVkOiAxLAogICAgICAgICAgdHJhbnNsYXRpb246IGRhdGEudHJhbnNsYXRpb24KICAgICAgICB9CiAgICAgICAgYnJlYWsKICAgICAgY2FzZSBDT01NQU5EX0FERF9HSUZUOiB7CiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZy5zaG93R2lmdCkgewogICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICAgICAgbGV0IHByaWNlID0gZGF0YS50b3RhbENvaW4gLyAxMDAwCiAgICAgICAgaWYgKHRoaXMubWVyZ2VTaW1pbGFyR2lmdChkYXRhLmF1dGhvck5hbWUsIHByaWNlLCBkYXRhLmdpZnROYW1lLCBkYXRhLm51bSkpIHsKICAgICAgICAgIGJyZWFrCiAgICAgICAgfQogICAgICAgIGlmIChwcmljZSA8IHRoaXMuY29uZmlnLm1pbkdpZnRQcmljZSkgeyAvLyDkuKLkuroKICAgICAgICAgIGJyZWFrCiAgICAgICAgfQogICAgICAgIG1lc3NhZ2UgPSB7CiAgICAgICAgICBpZDogZGF0YS5pZCwKICAgICAgICAgIHR5cGU6IGNvbnN0YW50cy5NRVNTQUdFX1RZUEVfR0lGVCwKICAgICAgICAgIGF2YXRhclVybDogZGF0YS5hdmF0YXJVcmwsCiAgICAgICAgICB0aW1lOiBuZXcgRGF0ZShkYXRhLnRpbWVzdGFtcCAqIDEwMDApLAogICAgICAgICAgYXV0aG9yTmFtZTogZGF0YS5hdXRob3JOYW1lLAogICAgICAgICAgcHJpY2U6IHByaWNlLAogICAgICAgICAgZ2lmdE5hbWU6IGRhdGEuZ2lmdE5hbWUsCiAgICAgICAgICBudW06IGRhdGEubnVtCiAgICAgICAgfQogICAgICAgIGJyZWFrCiAgICAgIH0KICAgICAgY2FzZSBDT01NQU5EX0FERF9MT1ZFOiB7CiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZy5zaG93TG92ZSB8fCB0aGlzLm1lcmdlU2ltaWxhck90aGVyKGRhdGEuYXV0aG9yTmFtZSwgZGF0YS5jb250ZW50KSkgewogICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICAgICAgbWVzc2FnZSA9IHsKICAgICAgICAgIGlkOiBkYXRhLmlkLAogICAgICAgICAgdHlwZTogY29uc3RhbnRzLk1FU1NBR0VfVFlQRV9MT1ZFLAogICAgICAgICAgYXZhdGFyVXJsOiBkYXRhLmF2YXRhclVybCwKICAgICAgICAgIHRpbWU6IG5ldyBEYXRlKGRhdGEudGltZXN0YW1wICogMTAwMCksCiAgICAgICAgICBhdXRob3JOYW1lOiBkYXRhLmF1dGhvck5hbWUsCiAgICAgICAgICBhdXRob3JUeXBlOiBkYXRhLmF1dGhvclR5cGUsCiAgICAgICAgICBjb250ZW50OiBkYXRhLmNvbnRlbnQsCiAgICAgICAgICBwcmljZTogMCwKICAgICAgICAgIHJlcGVhdGVkOiAxLAogICAgICAgICAgZ2lmdE5hbWU6IGRhdGEuZ2lmdE5hbWUsCiAgICAgICAgICBudW06IGRhdGEubnVtCiAgICAgICAgfQogICAgICAgIGJyZWFrCiAgICAgIH0KICAgICAgY2FzZSBDT01NQU5EX0FERF9GT0xMT1c6IHsKICAgICAgICBpZiAoIXRoaXMuY29uZmlnLnNob3dGb2xsb3cpIHsKICAgICAgICAgIGJyZWFrCiAgICAgICAgfQogICAgICAgIG1lc3NhZ2UgPSB7CiAgICAgICAgICBpZDogZGF0YS5pZCwKICAgICAgICAgIHR5cGU6IGNvbnN0YW50cy5NRVNTQUdFX1RZUEVfRk9MTE9XLAogICAgICAgICAgYXZhdGFyVXJsOiBkYXRhLmF2YXRhclVybCwKICAgICAgICAgIHRpbWU6IG5ldyBEYXRlKGRhdGEudGltZXN0YW1wICogMTAwMCksCiAgICAgICAgICBhdXRob3JOYW1lOiBkYXRhLmF1dGhvck5hbWUsCiAgICAgICAgICBjb250ZW50OiBkYXRhLmNvbnRlbnQsCiAgICAgICAgICBwcmljZTogMCwKICAgICAgICAgIGdpZnROYW1lOiBkYXRhLmdpZnROYW1lLAogICAgICAgICAgbnVtOiBkYXRhLm51bQogICAgICAgIH0KICAgICAgICBicmVhawogICAgICB9CiAgICAgIGNhc2UgQ09NTUFORF9BRERfTUVNQkVSOgogICAgICAgIGlmICghdGhpcy5jb25maWcuc2hvd0dpZnQgfHwgIXRoaXMuZmlsdGVyTmV3TWVtYmVyTWVzc2FnZShkYXRhKSkgewogICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICAgICAgbWVzc2FnZSA9IHsKICAgICAgICAgIGlkOiBkYXRhLmlkLAogICAgICAgICAgdHlwZTogY29uc3RhbnRzLk1FU1NBR0VfVFlQRV9NRU1CRVIsCiAgICAgICAgICBhdmF0YXJVcmw6IGRhdGEuYXZhdGFyVXJsLAogICAgICAgICAgdGltZTogbmV3IERhdGUoZGF0YS50aW1lc3RhbXAgKiAxMDAwKSwKICAgICAgICAgIGF1dGhvck5hbWU6IGRhdGEuYXV0aG9yTmFtZSwKICAgICAgICAgIHRpdGxlOiAnTkVXIE1FTUJFUiEnLAogICAgICAgICAgY29udGVudDogYFdlbGNvbWUgJHtkYXRhLmF1dGhvck5hbWV9IWAKICAgICAgICB9CiAgICAgICAgYnJlYWsKICAgICAgY2FzZSBDT01NQU5EX0FERF9TVVBFUl9DSEFUOgogICAgICAgIGlmICghdGhpcy5jb25maWcuc2hvd0dpZnQgfHwgIXRoaXMuZmlsdGVyU3VwZXJDaGF0TWVzc2FnZShkYXRhKSkgewogICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICAgICAgaWYgKGRhdGEucHJpY2UgPCB0aGlzLmNvbmZpZy5taW5HaWZ0UHJpY2UpIHsgLy8g5Lii5Lq6CiAgICAgICAgICBicmVhawogICAgICAgIH0KICAgICAgICBtZXNzYWdlID0gewogICAgICAgICAgaWQ6IGRhdGEuaWQsCiAgICAgICAgICB0eXBlOiBjb25zdGFudHMuTUVTU0FHRV9UWVBFX1NVUEVSX0NIQVQsCiAgICAgICAgICBhdmF0YXJVcmw6IGRhdGEuYXZhdGFyVXJsLAogICAgICAgICAgYXV0aG9yTmFtZTogZGF0YS5hdXRob3JOYW1lLAogICAgICAgICAgcHJpY2U6IGRhdGEucHJpY2UsCiAgICAgICAgICB0aW1lOiBuZXcgRGF0ZShkYXRhLnRpbWVzdGFtcCAqIDEwMDApLAogICAgICAgICAgY29udGVudDogZGF0YS5jb250ZW50LnRyaW0oKQogICAgICAgIH0KICAgICAgICBicmVhawogICAgICBjYXNlIENPTU1BTkRfREVMX1NVUEVSX0NIQVQ6CiAgICAgICAgZm9yIChsZXQgaWQgb2YgZGF0YS5pZHMpIHsKICAgICAgICAgIHRoaXMuJHJlZnMucmVuZGVyZXIuZGVsTWVzc2FnZShpZCkKICAgICAgICB9CiAgICAgICAgYnJlYWsKICAgICAgY2FzZSBDT01NQU5EX1VQREFURV9UUkFOU0xBVElPTjoKICAgICAgICBpZiAoIXRoaXMuY29uZmlnLmF1dG9UcmFuc2xhdGUpIHsKICAgICAgICAgIGJyZWFrCiAgICAgICAgfQogICAgICAgIGRhdGEgPSB7CiAgICAgICAgICBpZDogZGF0YVswXSwKICAgICAgICAgIHRyYW5zbGF0aW9uOiBkYXRhWzFdCiAgICAgICAgfQogICAgICAgIHRoaXMuJHJlZnMucmVuZGVyZXIudXBkYXRlTWVzc2FnZShkYXRhLmlkLCB7dHJhbnNsYXRpb246IGRhdGEudHJhbnNsYXRpb259KQogICAgICAgIGJyZWFrCiAgICAgIH0KICAgICAgaWYgKG1lc3NhZ2UpIHsKICAgICAgICB0aGlzLiRyZWZzLnJlbmRlcmVyLmFkZE1lc3NhZ2UobWVzc2FnZSkKICAgICAgfQogICAgCiAgICB9LAogICAgZmlsdGVyVGV4dE1lc3NhZ2UoZGF0YSkgewogICAgICBpZiAodGhpcy5jb25maWcuYmxvY2tHaWZ0RGFubWFrdSAmJiBkYXRhLmlzR2lmdERhbm1ha3UpIHsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfSBlbHNlIGlmICh0aGlzLmNvbmZpZy5ibG9ja0xldmVsID4gMCAmJiBkYXRhLmF1dGhvckxldmVsIDwgdGhpcy5jb25maWcuYmxvY2tMZXZlbCkgewogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9IGVsc2UgaWYgKHRoaXMuY29uZmlnLmJsb2NrTmV3YmllICYmIGRhdGEuaXNOZXdiaWUpIHsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfSBlbHNlIGlmICh0aGlzLmNvbmZpZy5ibG9ja05vdE1vYmlsZVZlcmlmaWVkICYmICFkYXRhLmlzTW9iaWxlVmVyaWZpZWQpIHsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfSBlbHNlIGlmICh0aGlzLmNvbmZpZy5ibG9ja01lZGFsTGV2ZWwgPiAwICYmIGRhdGEubWVkYWxMZXZlbCA8IHRoaXMuY29uZmlnLmJsb2NrTWVkYWxMZXZlbCkgewogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmZpbHRlclN1cGVyQ2hhdE1lc3NhZ2UoZGF0YSkKICAgIH0sCiAgICBmaWx0ZXJTdXBlckNoYXRNZXNzYWdlKGRhdGEpIHsKICAgICAgZm9yIChsZXQga2V5d29yZCBvZiB0aGlzLmJsb2NrS2V5d29yZHMpIHsKICAgICAgICBpZiAoZGF0YS5jb250ZW50LmluZGV4T2Yoa2V5d29yZCkgIT09IC0xKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyTmV3TWVtYmVyTWVzc2FnZShkYXRhKQogICAgfSwKICAgIGZpbHRlck5ld01lbWJlck1lc3NhZ2UoZGF0YSkgewogICAgICBmb3IgKGxldCB1c2VyIG9mIHRoaXMuYmxvY2tVc2VycykgewogICAgICAgIGlmIChkYXRhLmF1dGhvck5hbWUgPT09IHVzZXIpIHsKICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdHJ1ZQogICAgfSwKICAgIG1lcmdlU2ltaWxhclRleHQoY29udGVudCkgewogICAgICBpZiAoIXRoaXMuY29uZmlnLm1lcmdlU2ltaWxhckRhbm1ha3UpIHsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQogICAgICByZXR1cm4gdGhpcy4kcmVmcy5yZW5kZXJlci5tZXJnZVNpbWlsYXJUZXh0KGNvbnRlbnQpCiAgICB9LAogICAgbWVyZ2VTaW1pbGFyT3RoZXIoYXV0aG9yTmFtZSwgY29udGVudCkgewogICAgICBpZiAoIXRoaXMuY29uZmlnLm1lcmdlU2ltaWxhck90aGVyKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuJHJlZnMucmVuZGVyZXIubWVyZ2VTaW1pbGFyT3RoZXIoYXV0aG9yTmFtZSwgY29udGVudCkKICAgIH0sCiAgICBtZXJnZVNpbWlsYXJHaWZ0KGF1dGhvck5hbWUsIHByaWNlLCBnaWZ0TmFtZSwgbnVtKSB7CiAgICAgIGlmICghdGhpcy5jb25maWcubWVyZ2VHaWZ0KSB7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuJHJlZnMucmVuZGVyZXIubWVyZ2VTaW1pbGFyR2lmdChhdXRob3JOYW1lLCBwcmljZSwgZ2lmdE5hbWUsIG51bSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["Room.vue"],"names":[],"mappings":";;;;;AAKA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Room.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <chat-renderer ref=\"renderer\" :maxNumber=\"config.maxNumber\" :showGiftName=\"config.showGiftName\"  :showGiftPrice=\"config.showGiftPrice\"></chat-renderer>\n</template>\n\n<script>\nimport {mergeConfig, toBool, toInt} from '@/utils'\nimport * as config from '@/api/config'\nimport ChatRenderer from '@/components/ChatRenderer'\nimport * as constants from '@/components/ChatRenderer/constants'\n\nconst COMMAND_HEARTBEAT = 0\nconst COMMAND_JOIN_ROOM = 1\nconst COMMAND_ADD_TEXT = 2\nconst COMMAND_ADD_GIFT = 3\nconst COMMAND_ADD_MEMBER = 4\nconst COMMAND_ADD_SUPER_CHAT = 5\nconst COMMAND_DEL_SUPER_CHAT = 6\nconst COMMAND_UPDATE_TRANSLATION = 7\nconst COMMAND_ADD_LOVE = 8\nconst COMMAND_QUIT_ROOM = 9\nconst COMMAND_ADD_FOLLOW = 10\n\nexport default {\n  name: 'Room',\n  components: {\n    ChatRenderer\n  },\n  data() {\n    return {\n      config: {...config.DEFAULT_CONFIG},\n\n      websocket: null,\n      retryCount: 0,\n      isDestroying: false,\n      heartbeatTimerId: null\n    }\n  },\n  computed: {\n    blockKeywords() {\n      return this.config.blockKeywords.split('\\n').filter(val => val)\n    },\n    blockUsers() {\n      return this.config.blockUsers.split('\\n').filter(val => val)\n    }\n  },\n  created() {\n    this.updateConfig()\n    this.wsConnect()\n    // 提示用户已加载\n    this.$message({\n      message: 'Loaded',\n      duration: '500'\n    })\n  },\n  beforeDestroy() {\n    this.isDestroying = true\n    this.websocket.close()\n  },\n  methods: {\n    updateConfig() {\n      let cfg = {}\n      // 留空的使用默认值\n      for (let i in this.$route.query) {\n        if (this.$route.query[i] !== '') {\n          cfg[i] = this.$route.query[i]\n        }\n      }\n      cfg = mergeConfig(cfg, config.DEFAULT_CONFIG)\n      cfg.minGiftPrice = toInt(cfg.minGiftPrice, config.DEFAULT_CONFIG.minGiftPrice)\n      cfg.showDanmaku = toBool(cfg.showDanmaku)\n      cfg.showLove = toBool(cfg.showLove)\n      cfg.showFollow = toBool(cfg.showFollow)\n      cfg.showJoin = toBool(cfg.showJoin)\n      cfg.showQuit = toBool(cfg.showQuit)\n      cfg.showGift = toBool(cfg.showGift)\n      cfg.showGiftName = toBool(cfg.showGiftName)\n      cfg.showGiftPrice = toBool(cfg.showGiftPrice)\n      cfg.mergeSimilarDanmaku = toBool(cfg.mergeSimilarDanmaku)\n      cfg.mergeSimilarOther = toBool(cfg.mergeSimilarOther)\n      cfg.mergeGift = toBool(cfg.mergeGift)\n      cfg.maxNumber = toInt(cfg.maxNumber, config.DEFAULT_CONFIG.maxNumber)\n      cfg.blockGiftDanmaku = toBool(cfg.blockGiftDanmaku)\n      cfg.blockLevel = toInt(cfg.blockLevel, config.DEFAULT_CONFIG.blockLevel)\n      cfg.blockNewbie = toBool(cfg.blockNewbie)\n      cfg.blockNotMobileVerified = toBool(cfg.blockNotMobileVerified)\n      cfg.blockMedalLevel = toInt(cfg.blockMedalLevel, config.DEFAULT_CONFIG.blockMedalLevel)\n      cfg.autoTranslate = toBool(cfg.autoTranslate)\n\n      this.config = cfg\n    },\n    wsConnect() {\n      const protocol = window.location.protocol === 'https:' ? 'wss' : 'ws'\n      // 开发时使用localhost:12450\n      const host = process.env.NODE_ENV === 'development' ? 'localhost:12451' : window.location.host\n      const url = `${protocol}://${host}/chat`\n      this.websocket = new WebSocket(url)\n      this.websocket.onopen = this.onWsOpen\n      this.websocket.onclose = this.onWsClose\n      this.websocket.onmessage = this.onWsMessage\n      this.heartbeatTimerId = window.setInterval(this.sendHeartbeat, 10 * 1000)\n    },\n    sendHeartbeat() {\n      this.websocket.send(JSON.stringify({\n        cmd: COMMAND_HEARTBEAT\n      }))\n    },\n    onWsOpen() {\n      this.retryCount = 0\n      this.websocket.send(JSON.stringify({\n        cmd: COMMAND_JOIN_ROOM,\n        data: {\n          roomId: parseInt(this.$route.params.roomId),\n          config: {\n            autoTranslate: this.config.autoTranslate\n          }\n        }\n      }))\n    },\n    onWsClose() {\n      if (this.heartbeatTimerId) {\n        window.clearInterval(this.heartbeatTimerId)\n        this.heartbeatTimerId = null\n      }\n      if (this.isDestroying) {\n        return\n      }\n      window.console.log(`掉线重连中${++this.retryCount}`)\n      this.wsConnect()\n    },\n    onWsMessage(event) {\n      let {cmd, data} = JSON.parse(event.data)\n      let message = null\n      switch (cmd) {\n      case COMMAND_JOIN_ROOM:\n        if (!this.config.showJoin || this.mergeSimilarOther(data.authorName, data.content)) {\n          break\n        }\n        message = {\n          id: data.id,\n          type: constants.MESSAGE_TYPE_JOIN,\n          avatarUrl: data.avatarUrl,\n          time: new Date(data.timestamp * 1000),\n          authorName: data.authorName,\n          authorType: data.authorType,\n          content: data.content,\n          privilegeType: data.privilegeType,\n          repeated: 1,\n          translation: data.translation\n        }\n        break\n      case COMMAND_QUIT_ROOM:\n        if (!this.config.showQuit || this.mergeSimilarOther(data.authorName, data.content)) {\n          break\n        }\n        message = {\n          id: data.id,\n          type: constants.MESSAGE_TYPE_QUIT,\n          avatarUrl: data.avatarUrl,\n          time: new Date(data.timestamp * 1000),\n          authorName: data.authorName,\n          authorType: data.authorType,\n          content: data.content,\n          privilegeType: data.privilegeType,\n          repeated: 1,\n          translation: data.translation\n        }\n        break\n      case COMMAND_ADD_TEXT:\n        if (!this.config.showDanmaku || !this.filterTextMessage(data) || this.mergeSimilarText(data.content)) {\n          break\n        }\n        message = {\n          id: data.id,\n          type: constants.MESSAGE_TYPE_TEXT,\n          avatarUrl: data.avatarUrl,\n          time: new Date(data.timestamp * 1000),\n          authorName: data.authorName,\n          authorType: data.authorType,\n          content: data.content,\n          privilegeType: data.privilegeType,\n          repeated: 1,\n          translation: data.translation\n        }\n        break\n      case COMMAND_ADD_GIFT: {\n        if (!this.config.showGift) {\n          break\n        }\n        let price = data.totalCoin / 1000\n        if (this.mergeSimilarGift(data.authorName, price, data.giftName, data.num)) {\n          break\n        }\n        if (price < this.config.minGiftPrice) { // 丢人\n          break\n        }\n        message = {\n          id: data.id,\n          type: constants.MESSAGE_TYPE_GIFT,\n          avatarUrl: data.avatarUrl,\n          time: new Date(data.timestamp * 1000),\n          authorName: data.authorName,\n          price: price,\n          giftName: data.giftName,\n          num: data.num\n        }\n        break\n      }\n      case COMMAND_ADD_LOVE: {\n        if (!this.config.showLove || this.mergeSimilarOther(data.authorName, data.content)) {\n          break\n        }\n        message = {\n          id: data.id,\n          type: constants.MESSAGE_TYPE_LOVE,\n          avatarUrl: data.avatarUrl,\n          time: new Date(data.timestamp * 1000),\n          authorName: data.authorName,\n          authorType: data.authorType,\n          content: data.content,\n          price: 0,\n          repeated: 1,\n          giftName: data.giftName,\n          num: data.num\n        }\n        break\n      }\n      case COMMAND_ADD_FOLLOW: {\n        if (!this.config.showFollow) {\n          break\n        }\n        message = {\n          id: data.id,\n          type: constants.MESSAGE_TYPE_FOLLOW,\n          avatarUrl: data.avatarUrl,\n          time: new Date(data.timestamp * 1000),\n          authorName: data.authorName,\n          content: data.content,\n          price: 0,\n          giftName: data.giftName,\n          num: data.num\n        }\n        break\n      }\n      case COMMAND_ADD_MEMBER:\n        if (!this.config.showGift || !this.filterNewMemberMessage(data)) {\n          break\n        }\n        message = {\n          id: data.id,\n          type: constants.MESSAGE_TYPE_MEMBER,\n          avatarUrl: data.avatarUrl,\n          time: new Date(data.timestamp * 1000),\n          authorName: data.authorName,\n          title: 'NEW MEMBER!',\n          content: `Welcome ${data.authorName}!`\n        }\n        break\n      case COMMAND_ADD_SUPER_CHAT:\n        if (!this.config.showGift || !this.filterSuperChatMessage(data)) {\n          break\n        }\n        if (data.price < this.config.minGiftPrice) { // 丢人\n          break\n        }\n        message = {\n          id: data.id,\n          type: constants.MESSAGE_TYPE_SUPER_CHAT,\n          avatarUrl: data.avatarUrl,\n          authorName: data.authorName,\n          price: data.price,\n          time: new Date(data.timestamp * 1000),\n          content: data.content.trim()\n        }\n        break\n      case COMMAND_DEL_SUPER_CHAT:\n        for (let id of data.ids) {\n          this.$refs.renderer.delMessage(id)\n        }\n        break\n      case COMMAND_UPDATE_TRANSLATION:\n        if (!this.config.autoTranslate) {\n          break\n        }\n        data = {\n          id: data[0],\n          translation: data[1]\n        }\n        this.$refs.renderer.updateMessage(data.id, {translation: data.translation})\n        break\n      }\n      if (message) {\n        this.$refs.renderer.addMessage(message)\n      }\n    \n    },\n    filterTextMessage(data) {\n      if (this.config.blockGiftDanmaku && data.isGiftDanmaku) {\n        return false\n      } else if (this.config.blockLevel > 0 && data.authorLevel < this.config.blockLevel) {\n        return false\n      } else if (this.config.blockNewbie && data.isNewbie) {\n        return false\n      } else if (this.config.blockNotMobileVerified && !data.isMobileVerified) {\n        return false\n      } else if (this.config.blockMedalLevel > 0 && data.medalLevel < this.config.blockMedalLevel) {\n        return false\n      }\n      return this.filterSuperChatMessage(data)\n    },\n    filterSuperChatMessage(data) {\n      for (let keyword of this.blockKeywords) {\n        if (data.content.indexOf(keyword) !== -1) {\n          return false\n        }\n      }\n      return this.filterNewMemberMessage(data)\n    },\n    filterNewMemberMessage(data) {\n      for (let user of this.blockUsers) {\n        if (data.authorName === user) {\n          return false\n        }\n      }\n      return true\n    },\n    mergeSimilarText(content) {\n      if (!this.config.mergeSimilarDanmaku) {\n        return false\n      }\n      return this.$refs.renderer.mergeSimilarText(content)\n    },\n    mergeSimilarOther(authorName, content) {\n      if (!this.config.mergeSimilarOther) {\n        return false\n      }\n      return this.$refs.renderer.mergeSimilarOther(authorName, content)\n    },\n    mergeSimilarGift(authorName, price, giftName, num) {\n      if (!this.config.mergeGift) {\n        return false\n      }\n      return this.$refs.renderer.mergeSimilarGift(authorName, price, giftName, num)\n    }\n  }\n}\n</script>\n"]}]}